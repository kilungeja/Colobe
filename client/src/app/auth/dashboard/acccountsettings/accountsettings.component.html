<div class="row mx-auto">
  <div class="col-12" *ngIf="loading">
    <app-spinner></app-spinner>
  </div>
  <ng-container *ngIf="!loading && user">
    <div class="col-md-4">
      <div class="card card-body shadow-lg">
        <p class="text-center ">
          <i class="fas fa-user-circle fa-8x text-primary"></i>
        </p>
        <div id="user-items">
          <div
            class="d-flex justify-content-between align-content-between px-3 text-muted"
          >
            <p>Full name</p>
            <small>{{ user.firstname }} {{ user.lastname }}</small>
          </div>

          <div
            class="d-flex justify-content-between align-content-between px-3 text-muted"
          >
            <p>Username</p>
            <small>{{ user.username }}</small>
          </div>
          <div
            class="d-flex justify-content-between align-content-between px-3 text-muted"
          >
            <p><i class="fas fa-id-card-alt mr-2"></i>Reg. No</p>
            <small>{{ user.reg_no }}</small>
          </div>
          <div
            class="d-flex justify-content-between align-content-between px-3 text-muted"
          >
            <p><i class="fas fa-at mr-2"></i>E-mail</p>
            <small>{{ user.email }}</small>
          </div>

          <div
            class="d-flex justify-content-between align-content-between px-3 text-muted"
          >
            <p><i class="fas fa-user-clock mr-2"></i>Date joined</p>
            <small>{{ user.created_at | date }}</small>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-8">
      <div class="card card-body shadow-lg">
        <h4 class="card-title text-muted text-center mb-3">
          {{ state === "update" ? "Edit your profile" : "Your profile" }}
        </h4>
        <form #update="ngForm" (submit)="onSubmit(update)">
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="fname">First name</label>
                <input
                  type="text"
                  class="form-control"
                  [ngModel]="user.firstname"
                  [disabled]="state === 'edit'"
                  required
                  name="firstname"
                />
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="fname">Last name</label>
                <input
                  type="text"
                  class="form-control"
                  [ngModel]="user.lastname"
                  [disabled]="state === 'edit'"
                  required
                  name="lastname"
                />
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-6">
              <div class="form-group">
                <label for="fname">Username</label>
                <input
                  type="text"
                  class="form-control"
                  [ngModel]="user.username"
                  [disabled]="state === 'edit'"
                  required
                  name="username"
                />
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group">
                <label for="fname">E-mail address</label>
                <input
                  type="email"
                  class="form-control"
                  [ngModel]="user.email"
                  [disabled]="state === 'edit'"
                  required
                  name="email"
                />
              </div>
            </div>
          </div>
          <div class="form-group">
            <label for="phone">Phone number</label>
            <input
              type="text"
              class="form-control"
              [ngModel]="user.phone"
              [disabled]="state === 'edit'"
              required
              name="phone"
            />
          </div>
          <div class="row pt-2">
            <div class="col-md-6">
              <button
                [disabled]="(update.touched && update.invalid) || updating"
                class="btn btn-secondary btn-block"
                *ngIf="state === 'update'"
              >
                <i class="far fa-edit mr-2"></i
                >{{ updating ? "Updating..." : "Update" }}
              </button>
            </div>
            <div class="col-md-6">
              <button
                class="btn btn-secondary btn-block"
                *ngIf="state === 'edit'"
                (click)="onEdit()"
              >
                <i class="fas fa-user-edit mr-2"></i>Edit
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
  </ng-container>
</div>
